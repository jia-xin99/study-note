# 02 PC寄存器

## 概念

- **<font color = "66CCOO">PC寄存器存储下一条指令的地址</font>**，即将要执行的指令代码。由执行引擎读取下一条指令。
- 程序计数器存储当前线程正在执行的Java方法的JVM指令地址，若是native方法，则是未指定值。
- 它是程序控制流的指示器，分支、循环、跳转、异常处理、线程恢复等基础功能需要其完成。
- 字节码解释器工作时就是通过改变该寄存器的值选取下一条需要执行的字节码指令。
- **唯一没有OutOfMemoryError的区域。**

![](/jvm/6.png)

## 实例

&emsp;&emsp;**指令地址 : 操作指令**，PC寄存器存储指令地址。执行引擎读取PC寄存器中的指令。
![](/jvm/7.png)
&emsp;&emsp;我的理解：线程切换时会切换PC寄存器和虚拟机栈、本地方法栈，然后**调用执行引擎（不是执行引擎调用线程)对PC寄存器指向的指令解释执行**。每个Java线程的运行伴随执行引擎的执行过程，而非一个Java线程对应一个执行引擎线程。

## 问题

> 使用PC寄存器存储字节码指令地址的作用？
> 为什么使用PC寄存器记录当前线程的执行地址？

&emsp;&emsp;因为CPU不断切换各种线程，切换回来得知道从哪开始继续执行。JVM字节码解释器就是需要通过改变PC寄存器的值来明确下一条执行的字节码指令。
> PC寄存器为什么设定为线程私有？

&emsp;&emsp;为能够准确记录各个线程正在执行的字节码指令地址，最好的方法就是为每个线程分配一个PC寄存器。